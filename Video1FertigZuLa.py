from manim import *
#20x5=100 Personen-Icons als Sample
P1x1=SVGMobject("PersonIcon.svg",fill_color=WHITE,height=0.9,stroke_color=BLACK,z_index=3).move_to([-6.65,2.3,0])
P2x1=P1x1.copy().next_to(P1x1,1.4*RIGHT)
P3x1=P1x1.copy().next_to(P2x1,1.4*RIGHT)
P4x1=P1x1.copy().next_to(P3x1,1.4*RIGHT)
P5x1=P1x1.copy().next_to(P4x1,1.4*RIGHT)
P6x1=P1x1.copy().next_to(P5x1,1.4*RIGHT)
P7x1=P1x1.copy().next_to(P6x1,1.4*RIGHT)
P8x1=P1x1.copy().next_to(P7x1,1.4*RIGHT)
P9x1=P1x1.copy().next_to(P8x1,1.4*RIGHT)
P10x1=P1x1.copy().next_to(P9x1,1.4*RIGHT)
P11x1=P1x1.copy().next_to(P10x1,1.4*RIGHT)
P12x1=P1x1.copy().next_to(P11x1,1.4*RIGHT)
P13x1=P1x1.copy().next_to(P12x1,1.4*RIGHT)
P14x1=P1x1.copy().next_to(P13x1,1.4*RIGHT)
P15x1=P1x1.copy().next_to(P14x1,1.4*RIGHT)
P16x1=P1x1.copy().next_to(P15x1,1.4*RIGHT)
P17x1=P1x1.copy().next_to(P16x1,1.4*RIGHT)
P18x1=P1x1.copy().next_to(P17x1,1.4*RIGHT)
P19x1=P1x1.copy().next_to(P18x1,1.4*RIGHT)
P20x1=P1x1.copy().next_to(P19x1,1.4*RIGHT)

P1x2=P1x1.copy().next_to(P1x1,DOWN)
P2x2=P1x1.copy().next_to(P2x1,DOWN)
P3x2=P1x1.copy().next_to(P3x1,DOWN)
P4x2=P1x1.copy().next_to(P4x1,DOWN)
P5x2=P1x1.copy().next_to(P5x1,DOWN)
P6x2=P1x1.copy().next_to(P6x1,DOWN)
P7x2=P1x1.copy().next_to(P7x1,DOWN)
P8x2=P1x1.copy().next_to(P8x1,DOWN)
P9x2=P1x1.copy().next_to(P9x1,DOWN)
P10x2=P1x1.copy().next_to(P10x1,DOWN)
P11x2=P1x1.copy().next_to(P11x1,DOWN)
P12x2=P1x1.copy().next_to(P12x1,DOWN)
P13x2=P1x1.copy().next_to(P13x1,DOWN)
P14x2=P1x1.copy().next_to(P14x1,DOWN)
P15x2=P1x1.copy().next_to(P15x1,DOWN)
P16x2=P1x1.copy().next_to(P16x1,DOWN)
P17x2=P1x1.copy().next_to(P17x1,DOWN)
P18x2=P1x1.copy().next_to(P18x1,DOWN)
P19x2=P1x1.copy().next_to(P19x1,DOWN)
P20x2=P1x1.copy().next_to(P20x1,DOWN)

P1x3=P1x1.copy().next_to(P1x2,DOWN)
P2x3=P1x1.copy().next_to(P2x2,DOWN)
P3x3=P1x1.copy().next_to(P3x2,DOWN)
P4x3=P1x1.copy().next_to(P4x2,DOWN)
P5x3=P1x1.copy().next_to(P5x2,DOWN)
P6x3=P1x1.copy().next_to(P6x2,DOWN)
P7x3=P1x1.copy().next_to(P7x2,DOWN)
P8x3=P1x1.copy().next_to(P8x2,DOWN)
P9x3=P1x1.copy().next_to(P9x2,DOWN)
P10x3=P1x1.copy().next_to(P10x2,DOWN)
P11x3=P1x1.copy().next_to(P11x2,DOWN)
P12x3=P1x1.copy().next_to(P12x2,DOWN)
P13x3=P1x1.copy().next_to(P13x2,DOWN)
P14x3=P1x1.copy().next_to(P14x2,DOWN)
P15x3=P1x1.copy().next_to(P15x2,DOWN)
P16x3=P1x1.copy().next_to(P16x2,DOWN)
P17x3=P1x1.copy().next_to(P17x2,DOWN)
P18x3=P1x1.copy().next_to(P18x2,DOWN)
P19x3=P1x1.copy().next_to(P19x2,DOWN)
P20x3=P1x1.copy().next_to(P20x2,DOWN)

P1x4=P1x1.copy().next_to(P1x3,DOWN)
P2x4=P1x1.copy().next_to(P2x3,DOWN)
P3x4=P1x1.copy().next_to(P3x3,DOWN)
P4x4=P1x1.copy().next_to(P4x3,DOWN)
P5x4=P1x1.copy().next_to(P5x3,DOWN)
P6x4=P1x1.copy().next_to(P6x3,DOWN)
P7x4=P1x1.copy().next_to(P7x3,DOWN)
P8x4=P1x1.copy().next_to(P8x3,DOWN)
P9x4=P1x1.copy().next_to(P9x3,DOWN)
P10x4=P1x1.copy().next_to(P10x3,DOWN)
P11x4=P1x1.copy().next_to(P11x3,DOWN)
P12x4=P1x1.copy().next_to(P12x3,DOWN)
P13x4=P1x1.copy().next_to(P13x3,DOWN)
P14x4=P1x1.copy().next_to(P14x3,DOWN)
P15x4=P1x1.copy().next_to(P15x3,DOWN)
P16x4=P1x1.copy().next_to(P16x3,DOWN)
P17x4=P1x1.copy().next_to(P17x3,DOWN)
P18x4=P1x1.copy().next_to(P18x3,DOWN)
P19x4=P1x1.copy().next_to(P19x3,DOWN)
P20x4=P1x1.copy().next_to(P20x3,DOWN)

P1x5=P1x1.copy().next_to(P1x4,DOWN)
P2x5=P1x1.copy().next_to(P2x4,DOWN)
P3x5=P1x1.copy().next_to(P3x4,DOWN)
P4x5=P1x1.copy().next_to(P4x4,DOWN)
P5x5=P1x1.copy().next_to(P5x4,DOWN)
P6x5=P1x1.copy().next_to(P6x4,DOWN)
P7x5=P1x1.copy().next_to(P7x4,DOWN)
P8x5=P1x1.copy().next_to(P8x4,DOWN)
P9x5=P1x1.copy().next_to(P9x4,DOWN)
P10x5=P1x1.copy().next_to(P10x4,DOWN)
P11x5=P1x1.copy().next_to(P11x4,DOWN)
P12x5=P1x1.copy().next_to(P12x4,DOWN)
P13x5=P1x1.copy().next_to(P13x4,DOWN)
P14x5=P1x1.copy().next_to(P14x4,DOWN)
P15x5=P1x1.copy().next_to(P15x4,DOWN)
P16x5=P1x1.copy().next_to(P16x4,DOWN)
P17x5=P1x1.copy().next_to(P17x4,DOWN)
P18x5=P1x1.copy().next_to(P18x4,DOWN)
P19x5=P1x1.copy().next_to(P19x4,DOWN)
P20x5=P1x1.copy().next_to(P20x4,DOWN)

Alle=VGroup(P1x1,P2x1,P3x1,P4x1,P5x1,P6x1,P7x1,P8x1,P9x1,P10x1,
            P1x2,P2x2,P3x2,P4x2,P5x2,P6x2,P7x2,P8x2,P9x2,P10x2,
            P1x3,P2x3,P3x3,P4x3,P5x3,P6x3,P7x3,P8x3,P9x3,P10x3,
            P1x4,P2x4,P3x4,P4x4,P5x4,P6x4,P7x4,P8x4,P9x4,P10x4,
            P1x5,P2x5,P3x5,P4x5,P5x5,P6x5,P7x5,P8x5,P9x5,P10x5,
            P11x1,P12x1,P13x1,P14x1,P15x1,P16x1,P17x1,P18x1,P19x1,P20x1,
            P11x2,P12x2,P13x2,P14x2,P15x2,P16x2,P17x2,P18x2,P19x2,P20x2,
            P11x3,P12x3,P13x3,P14x3,P15x3,P16x3,P17x3,P18x3,P19x3,P20x3,
            P11x4,P12x4,P13x4,P14x4,P15x4,P16x4,P17x4,P18x4,P19x4,P20x4,
            P11x5,P12x5,P13x5,P14x5,P15x5,P16x5,P17x5,P18x5,P19x5,P20x5)
#Grupierung der Gymnasiasten
Gym=VGroup(P1x1,P2x1,P3x1,P4x1,P5x1,P6x1,P7x1,P8x1,P9x1,P10x1,
            P1x2,P2x2,P3x2,P4x2,P5x2,P6x2,P7x2,P8x2,P9x2,P10x2,
            P1x3,P2x3,P3x3,P4x3,P5x3,P6x3,P7x3,P8x3,P9x3,P10x3,
            P1x4,P2x4,P3x4,P4x4,P5x4,P6x4,P7x4,P8x4,P9x4,P10x4,
            P1x5,P2x5,P3x5,P4x5,P5x5,P6x5,P7x5,P8x5,P9x5,P10x5)
KlammerGym=Brace(Gym).next_to(Gym,DOWN)
TextGym=Text("Gymnasiasten", color=BLUE).next_to(KlammerGym,0.1*DOWN).scale(0.7)


#Grupierung der nicht-Gymnasiasten
notGym=VGroup(P11x1,P12x1,P13x1,P14x1,P15x1,P16x1,P17x1,P18x1,P19x1,P20x1,
                P11x2,P12x2,P13x2,P14x2,P15x2,P16x2,P17x2,P18x2,P19x2,P20x2,
                P11x3,P12x3,P13x3,P14x3,P15x3,P16x3,P17x3,P18x3,P19x3,P20x3,
                P11x4,P12x4,P13x4,P14x4,P15x4,P16x4,P17x4,P18x4,P19x4,P20x4,
                P11x5,P12x5,P13x5,P14x5,P15x5,P16x5,P17x5,P18x5,P19x5,P20x5)
KlammerNotGym=Brace(notGym).next_to(notGym,DOWN)
TextNotGym=Text("Nicht-Gymnasiasten", color=RED).next_to(KlammerNotGym,0.1*DOWN).scale(0.7)


#Grupperung der Gymnasiasten mit niedrigem sozioökonomischem Status (5)
GymNiedrig=VGroup(P1x1,P2x1,P3x1,P4x1,P5x1)

#Grupperung der nicht-Gymnasiasten mit niedrigem sozioökonomischem Status (20)
notGymNiedrig=VGroup(P11x1,P12x1,P13x1,P14x1,P15x1,P16x1,P17x1,P18x1,P19x1,P20x1,
                    P11x2,P12x2,P13x2,P14x2,P15x2,P16x2,P17x2,P18x2,P19x2,P20x2)
#Jeweils gelber Rahmen um beide Gruppen mit niedrigem s.ö. Status
RahmenGymNiedrig=always_redraw(lambda: SurroundingRectangle(GymNiedrig,color='#FFFF00', buff=0.1,stroke_width=10,z_index=0).set_fill('#FFFF00',opacity=1))
RahmenNotGymNiedrig=always_redraw(lambda:SurroundingRectangle(notGymNiedrig,color='#FFFF00', buff=0.1,stroke_width=10,z_index=0).set_fill('#FFFF00',opacity=1))



#Grupierung Gymnasiasten mit mittlerem s.ö. Status
GymMittel=VGroup(P6x1,P7x1,P8x1,P9x1,P10x1,
                P1x2,P2x2,P3x2,P4x2,P5x2,P6x2,P7x2,P8x2,P9x2,P10x2,
                P1x3,P2x3,P3x3,P4x3,P5x3,P6x3,P7x3,P8x3,P9x3,P10x3)

#Grupierung Gymnasiasten mit hohem s.ö. Status
GymHoch=VGroup(P1x4,P2x4,P3x4,P4x4,P5x4,P6x4,P7x4,P8x4,P9x4,P10x4,
                P1x5,P2x5,P3x5,P4x5,P5x5,P6x5,P7x5,P8x5,P9x5,P10x5)

#Grupierung nicht-Gymnasiasten mit mittlerem s.ö. Status
notGymMittel=VGroup(P11x3,P12x3,P13x3,P14x3,P15x3,P16x3,P17x3,P18x3,P19x3,P20x3,
                    P11x4,P12x4,P13x4,P14x4,P15x4,P16x4,P17x4,P18x4,P19x4,P20x4,
                    P11x5,P12x5,P13x5,P14x5,P15x5)

#Grupierung nicht-Gymnasiasten mit hohem s.ö. Status
notGymHoch=VGroup(P16x5,P17x5,P18x5,P19x5,P20x5)

#Grupierung aller mit niedrigem Status
Niedrig=VGroup(P1x1,P2x1,P3x1,P4x1,P5x1,P11x1,P12x1,P13x1,P14x1,P15x1,P16x1,P17x1,P18x1,P19x1,P20x1,
                    P11x2,P12x2,P13x2,P14x2,P15x2,P16x2,P17x2,P18x2,P19x2,P20x2)



RahmenGymMittel=SurroundingRectangle(GymMittel,color=GREEN, buff=0.1,stroke_width=10,z_index=-1).set_fill(GREEN,opacity=1)
RahmenGymHoch=SurroundingRectangle(GymHoch,color=ORANGE, buff=0.1,stroke_width=10,z_index=0).set_fill(ORANGE,opacity=1)
RahmenNotGymHoch=SurroundingRectangle(notGymHoch,color=ORANGE, buff=0.1,stroke_width=10,z_index=0).set_fill(ORANGE,opacity=1)
RahmenNotGymMittel=SurroundingRectangle(notGymMittel,color=GREEN, buff=0.1,stroke_width=10,z_index=-1).set_fill(GREEN,opacity=1)
HilfsrahmenNotGymMittel=SurroundingRectangle(notGymHoch,color=BLACK, buff=0.1,stroke_width=10,z_index=0).set_fill(BLACK,opacity=1)








class Scene1(Scene):
    def construct(self):
        
        #Zeigt 100 Personen

        self.add(P1x1,P2x1,P3x1,P4x1,P5x1,P6x1,P7x1,P8x1,P9x1,P10x1,P11x1,P12x1,P13x1,P14x1,P15x1,P16x1,P17x1,P18x1,P19x1,P20x1,
                        P1x2,P2x2,P3x2,P4x2,P5x2,P6x2,P7x2,P8x2,P9x2,P10x2,P11x2,P12x2,P13x2,P14x2,P15x2,P16x2,P17x2,P18x2,P19x2,P20x2,
                        P1x3,P2x3,P3x3,P4x3,P5x3,P6x3,P7x3,P8x3,P9x3,P10x3,P11x3,P12x3,P13x3,P14x3,P15x3,P16x3,P17x3,P18x3,P19x3,P20x3,
                        P1x4,P2x4,P3x4,P4x4,P5x4,P6x4,P7x4,P8x4,P9x4,P10x4,P11x4,P12x4,P13x4,P14x4,P15x4,P16x4,P17x4,P18x4,P19x4,P20x4,
                        P1x5,P2x5,P3x5,P4x5,P5x5,P6x5,P7x5,P8x5,P9x5,P10x5,P11x5,P12x5,P13x5,P14x5,P15x5,P16x5,P17x5,P18x5,P19x5,P20x5
        
        )

        self.wait(2)

        
        #Färbt Gymnasiasten Blau
        self.play(FadeIn(KlammerGym,TextGym),Gym.animate.set_fill(BLUE))
        self.wait(2)
        #Gelber Rahmen um Gymnasiasten mit niedrigem Status
        self.play(FadeIn(RahmenGymNiedrig))
        self.wait(2)
        #Färbt nicht-Gymnasiasten Rot
        self.play(FadeIn(KlammerNotGym,TextNotGym,RahmenNotGymNiedrig),notGym.animate.set_fill(RED))

        #Jeweils gelber Rahmen um beide Gruppen mit niedrigem s.ö. Status
        #self.play(FadeIn(RahmenGymNiedrig,RahmenNotGymNiedrig),run_time=4)
        #self.add(RahmenGymMittel,RahmenNotGymMittel,HilfsrahmenNotGymMittel)
        #self.wait(5)
        #self.play(FadeIn(RahmenGymHoch,RahmenNotGymHoch),FadeOut(HilfsrahmenNotGymMittel),run_time=4)

        self.wait(2)
        BedingteWahrscheinlichkeitOhneBedingung=Tex(r"$P(G)$",substrings_to_isolate="G").to_edge(UP).set_color_by_tex("G",BLUE)
        BedingteWahrscheinlichkeit=Tex(r"$P_\textbf{N}(G)$",substrings_to_isolate=["N","G"]).to_edge(UP)
        BedingteWahrscheinlichkeit.set_color_by_tex("N",YELLOW).set_color_by_tex("G",BLUE)
        self.play(FadeIn(BedingteWahrscheinlichkeitOhneBedingung))
        self.wait(2)
        self.play(TransformMatchingShapes(BedingteWahrscheinlichkeitOhneBedingung,BedingteWahrscheinlichkeit),run_time=4)
        self.wait(2)
        #Macht alle Gruppen mit nicht niedrigem Status transparenter
        self.play(GymMittel.animate.set_fill(opacity=0.3).set_stroke(opacity=0.3),
                    GymHoch.animate.set_fill(opacity=0.3).set_stroke(opacity=0.3),
                    notGymMittel.animate.set_fill(opacity=0.3).set_stroke(opacity=0.3),
                    notGymHoch.animate.set_fill(opacity=0.3).set_stroke(opacity=0.3),
                    #KlammerGym.animate.set_fill(opacity=0.3),KlammerNotGym.animate.set_fill(opacity=0.3),
                    #TextGym.animate.set_fill(opacity=0.3),TextNotGym.animate.set_fill(opacity=0.3),
                    #RahmenGymHoch.animate.set_fill(opacity=0.3).set_stroke(opacity=0.3),
                    #RahmenGymMittel.animate.set_fill(opacity=0.3).set_stroke(opacity=0.3),
                    #RahmenNotGymHoch.animate.set_fill(opacity=0.3).set_stroke(opacity=0.3),
                    #RahmenNotGymMittel.animate.set_fill(opacity=0.3).set_stroke(opacity=0.3),
                    run_time=4)
        
        
        self.wait(2)
        

        for x in Niedrig:
            x.scale(1.3)
        
        #Nur noch niedriger Status
        self.play(FadeOut(#RahmenNotGymMittel,
                            #RahmenNotGymHoch,
                            #RahmenGymNiedrig,
                            #RahmenGymHoch,
                            #RahmenGymMittel,
                            #RahmenNotGymNiedrig,
                            GymMittel,
                            GymHoch,
                            notGymHoch,
                            notGymMittel,
                            KlammerGym,
                            KlammerNotGym,
                            TextGym,
                            TextNotGym
                            ),
                        Niedrig.animate.arrange_in_grid(cols=5,buff=(1.2,0.25)).move_to([-3.1,0,0]),
                        BedingteWahrscheinlichkeit.animate.move_to([3,0,0]).scale(1.4),
                        run_time=4)

        self.wait(2)
        KlammerZähler=Brace(GymNiedrig,direction=[1, 0, 0.]).next_to(GymNiedrig,RIGHT)
        Zähler=Integer(5,z_index=2).set_color(BLUE).scale(1.5).next_to(KlammerZähler,RIGHT)
        KlammerNotGymNiedrig=Brace(notGymNiedrig,direction=[1, 0, 0.]).next_to(notGymNiedrig,RIGHT)
        AnzahlNotGymNiedrig=Integer(20,z_index=2).set_color(RED).scale(1.5).next_to(KlammerNotGymNiedrig,RIGHT)
        Zähler2=Zähler.copy()
        Zähler3=Zähler.copy()
        Zähler4=Zähler.copy()

        GelbesRechteck=VGroup(RahmenGymNiedrig,RahmenNotGymNiedrig)
        CopyGelbesRechteck=GelbesRechteck.copy()
        AnzahlNotGymNiedrig2=AnzahlNotGymNiedrig.copy()
        #self.play(FadeIn(Zähler,KlammerZähler,AnzahlNotGymNiedrig,KlammerNotGymNiedrig))
        self.add(Zähler,KlammerZähler,AnzahlNotGymNiedrig,KlammerNotGymNiedrig)

        self.wait(2)


        #Bruch der bedingten Wahrscheinlichkeit
        Bruch=Tex(r"$={{{5}} \over {{5}}+{{20}}}$").set_color_by_tex("5",BLACK).set_color_by_tex("20",BLACK).scale(1.8).next_to(BedingteWahrscheinlichkeit,RIGHT)
        Bruch2=Tex(r"$={{{5}} \over {{25}}}$",substrings_to_isolate=["5","25"]).set_color_by_tex("5",BLACK).set_color_by_tex("25",YELLOW).scale(1.8).next_to(Bruch,DOWN-[0.1,0,0])

        #for x in range(len(Bruch)):
        #    print(Bruch[x])
        #Zeigt Anzahl Gymnasisaten bzw. nicht-Gymnasiasten mit niedrigem Status
       
        #Animiert Zahlen zu Bruch
        self.play(Zähler3.animate.move_to(Bruch[1].get_center()),
                Zähler2.animate.move_to(Bruch[3].get_center()),
                AnzahlNotGymNiedrig2.animate.move_to(Bruch[5].get_center()),
                FadeIn(Bruch),run_time=3)
        #for x in range(len(Bruch2)):
        #    print(Bruch2[x])
        #self.play(FadeIn(Bruch2))
        self.wait(2)
        self.play(FadeIn(Bruch2),Zähler4.animate.move_to(Bruch2[2]),Transform(CopyGelbesRechteck,Bruch2[4]),run_time=2.5)

        self.wait(4)





class Scene2(Scene):
    def construct(self):
        for x in range(len(Alle)):
            Alle[x].scale(0.5)
            
        Alle.arrange_in_grid(cols=10,col_widths=[0.3, 0.3, 0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3],
            row_heights=[0.3, 0.3, 0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3]).to_corner(DOWN+LEFT)
        Gym.set_fill(BLUE)
        notGym.set_fill(RED)
        #RahmenGym=SurroundingRectangle(Gym,color=BLUE, buff=0.1,stroke_width=10,z_index=-3).set_fill(BLUE,opacity=1)
        #RahmenNotGym=SurroundingRectangle(notGym,color=RED, buff=0.1,stroke_width=10,z_index=-3).set_fill(RED,opacity=1)
        self.add(Gym,notGym,RahmenGym,RahmenNotGym)


        self.wait(5)














Bruch2=Tex(r"$\frac{\frac{5}{100}}{\frac{5}{100}+\frac{20}{100}}$",color=WHITE).scale(2).move_to([-4.3,0,0])
Bruch3=Tex(r"$=\frac{5\cdot\frac{1}{100}}{5\cdot\frac{1}{100}+20\cdot\frac{1}{100}}$",color=WHITE).scale(2)#.next_to(Bruch2,RIGHT)



class Scene3(Scene):
    def construct(self):
        for x in range(len(Bruch3)):
            print(Bruch3[x])
        self.add(Bruch.set_color_by_tex("5",BLUE).set_color_by_tex("20",RED).move_to([5.2,0,0]),Bruch2)
        self.add(Bruch3)
        

        self.wait(5)



class Count(Animation):
    def __init__(self, number: DecimalNumber, start: float, end: float, **kwargs) -> None:
        # Pass number as the mobject of the animation
        super().__init__(number,  **kwargs)
        # Set start and end
        self.start = start
        self.end = end

    def interpolate_mobject(self, alpha: float) -> None:
        # Set value of DecimalNumber according to alpha
        value = self.start + (alpha * (self.end - self.start))
        self.mobject.set_value(value)


class CountInt(Animation):
    def __init__(self, number: DecimalNumber, start: int, end: int, **kwargs) -> None:
        # Pass number as the mobject of the animation
        super().__init__(number,  **kwargs)
        # Set start and end
        self.start = start
        self.end = end

    def interpolate_mobject(self, alpha: int) -> None:
        # Set value of DecimalNumber according to alpha
        value = self.start + (alpha * (self.end - self.start))
        self.mobject.set_value(value)







class Scene4(Scene):
    def construct(self):
        
        Überschrift=Tex(r"Ziel: Berechnung von $P_B(A)$").to_edge(UP)
        ul=Underline(Überschrift)
        self.add(Überschrift,ul)
        self.wait(2)
        #EreignisABeginn=Rectangle(height=4,width=xStart,color=BLUE).set_fill(BLUE,opacity=1).move_to([-6.5,0,0]).set_stroke(BLACK,opacity=0)
        #EreignisBBeginn=Rectangle(height=4,width=yStart,color=RED).set_fill(RED,opacity=1).next_to(EreignisABeginn,buff=[0,0,0]).set_stroke(BLACK,opacity=0)
        
        
        
        xStart=2
        yStart=2
        EreignisAStart=Rectangle(height=4,width=xStart,color=BLUE,z_index=-1).set_fill(BLUE,opacity=1).move_to([-6,-0.2,0]).set_stroke(BLACK,opacity=0)
        EreignisBStart=Rectangle(height=4,width=yStart,color=RED,z_index=-1).set_fill(RED,opacity=1).next_to(EreignisAStart,buff=[0,0,0]).set_stroke(BLACK,opacity=0)
        Ereignisraum=Rectangle(height=4,width=4,z_index=-1).align_to(EreignisAStart,LEFT+DOWN)
        EreignisraumText=Tex(r"$\Omega$").move_to(Ereignisraum.get_center())
        EreignisAStartText=always_redraw(lambda:Tex(r"$A$",color=BLACK).move_to(EreignisAStart.get_center()))
        EreignisBStartText=always_redraw(lambda:Tex(r"$\bar{A}$",color=BLACK).move_to(EreignisBStart.get_center()))


        ÜberschriftLinkesDiagramm=Tex(r"Alle Möglichkeiten").move_to((EreignisAStart.get_top()+EreignisBStart.get_top())/2+[0,0.5,0])
        
        xMitte=0.75
        yMitte=3.25
        EreignisAMitte=Rectangle(height=4,width=xMitte,color=BLUE).set_fill(BLUE,opacity=1).align_to(EreignisAStart, LEFT+UP).set_stroke(BLACK,opacity=0)
        EreignisBMitte=Rectangle(height=4,width=yMitte,color=RED).set_fill(RED,opacity=1).next_to(EreignisAMitte,buff=[0,0,0]).set_stroke(BLACK,opacity=0)
        
        xEnde=2.2
        yEnde=1.8
        EreignisAEnde=Rectangle(height=4,width=xEnde,color=BLUE).set_fill(BLUE,opacity=1).align_to(EreignisAStart, LEFT+UP).set_stroke(BLACK,opacity=0)
        EreignisBEnde=Rectangle(height=4,width=yEnde,color=RED).set_fill(RED,opacity=1).next_to(EreignisAEnde,buff=[0,0,0]).set_stroke(BLACK,opacity=0)

        BraceA=always_redraw(lambda:Brace(EreignisAStart,DOWN))
        #Brace(EreignisAStart,direction=[0, -1, 0.]).add_updater(lambda BraceA: BraceA.next_to(EreignisAStart,DOWN))
        BraceB=always_redraw(lambda:Brace(EreignisBStart,direction=[0, -1, 0.]).next_to(EreignisBStart,DOWN))
        PvonA=always_redraw(lambda:Integer(number=round((EreignisAStart.get_width())/4*100)).next_to(BraceA,DOWN))
        PvonB=always_redraw(lambda:Integer(number=round(EreignisBStart.get_width()/4*100)).next_to(BraceB,DOWN))
        #f_always(PvonA.set_value, EreignisAStart.get_width)
        #f_always(PvonB.set_value, EreignisBStart.get_width)

        #PvonA.add_updater(lambda PvonA: PvonA.next_to(BraceA,DOWN))
        #PvonB.add_updater(lambda PvonB: PvonB.next_to(BraceB,DOWN))
        self.add(Ereignisraum,EreignisraumText,ÜberschriftLinkesDiagramm)
        self.wait(3)
        self.remove(Ereignisraum,EreignisraumText)
        self.add(EreignisAStart,EreignisBStart,EreignisAStartText,EreignisBStartText)
        self.wait(2)
        self.add(BraceA,BraceB,PvonA,PvonB)
        self.wait(3)
        self.play(Transform(EreignisAStart,EreignisAMitte),Transform(EreignisBStart,EreignisBMitte),CountInt(PvonA, round(xStart/4*100), round(xMitte/4*100)),CountInt(PvonB,round(yStart/4*100),round(yMitte/4*100)),rate_func=linear,run_time=2)
        
        #self.wait(2)
        self.play(Transform(EreignisAStart,EreignisAEnde),Transform(EreignisBStart,EreignisBEnde),CountInt(PvonA, round(xMitte/4*100), round(xEnde/4*100)),CountInt(PvonB,round(yMitte/4*100),round(yEnde/4*100)),rate_func=linear,run_time=2)
        self.wait(2)




        #Zweites Diagramm
        EreignisA=EreignisAStart.copy().next_to(EreignisBStart,RIGHT,buff=[0.55,0,0])
        EreignisB=EreignisBStart.copy().next_to(EreignisA,RIGHT,buff=[0,0,0])
        EreignisAText=EreignisAStartText.copy().move_to(EreignisA)
        EreignisBText=EreignisBStartText.copy().move_to(EreignisB)
 
        ÜberschriftRechtesDiagramm=Tex(r"...unter der Bedingung").move_to((EreignisA.get_top()+EreignisB.get_top())/2+[0,0.5,0])
        #BraceAMitte=always_redraw(lambda:Brace(EreignisA,DOWN))
        #BraceBMitte=always_redraw(lambda:Brace(EreignisB,DOWN))
        #PvonAMitte=always_redraw(lambda:Integer(number=round(EreignisA.get_width()/4*100)).next_to(BraceAMitte,DOWN))
        #PvonBMitte=always_redraw(lambda:Integer(number=round(EreignisB.get_width()/4*100)).next_to(BraceBMitte,DOWN))


        aLinieStart=Line(start=[0,0,0],end=[1,0,0],color=BLACK,z_index=-10)
        bLinieStart=Line(start=[0,0,0],end=[2,0,0],color=BLACK,z_index=-10)
        aStart=1
        bStart=2
        BedingungA=always_redraw(lambda:Rectangle(height=aLinieStart.get_length(),width=EreignisAStart.get_width(),color=YELLOW,z_index=0).set_fill(YELLOW,opacity=1).align_to(EreignisA,LEFT+DOWN).set_stroke(BLACK,opacity=0))
        BedingungB=always_redraw(lambda:Rectangle(height=bLinieStart.get_length(),width=EreignisBStart.get_width(),color=ORANGE,z_index=0).set_fill(ORANGE,opacity=1).align_to(EreignisB,RIGHT+DOWN).set_stroke(BLACK,opacity=0))
        EreignisAcapnotBText=always_redraw(lambda:Tex(r"$A\cap \bar{B}$",color=BLACK,z_index=3).move_to(EreignisA.get_center()+[0,aLinieStart.get_length()/2,0]))
        EreignisnotAcapnotBText=always_redraw(lambda:Tex(r"$\bar{A}\cap \bar{B}$",color=BLACK,z_index=3).move_to(EreignisB.get_center()+[0,bLinieStart.get_length()/2,0]))
        EreignisAcapBText=always_redraw(lambda:Tex(r"$A\cap B$",color=BLACK,z_index=3).move_to(BedingungA.get_center()))
        EreignisnotAcapBText=always_redraw(lambda:Tex(r"$\bar{A}\cap B$",color=BLACK,z_index=3).move_to(BedingungB.get_center()))

        self.add(EreignisA,EreignisB,EreignisAText,EreignisBText)
        self.wait(2)
        EreignisA.set_color(GREEN)
        self.remove(EreignisAText)
        self.add(BedingungA)
        #self.wait(2)
        self.add(EreignisAcapBText,EreignisAcapnotBText)
        self.wait(2)
        self.remove(EreignisBText)
        self.add(EreignisnotAcapnotBText,EreignisnotAcapBText)
        self.add(BedingungB)
        EreignisB.set_color(PURPLE)
        self.wait(2)
        self.add(ÜberschriftRechtesDiagramm)
        
        self.remove(EreignisA,EreignisB,EreignisAcapBText,EreignisAcapnotBText,EreignisnotAcapnotBText,EreignisnotAcapBText)

        EreignisA=always_redraw(lambda:EreignisAStart.copy().next_to(EreignisBStart,RIGHT,buff=[0.55,0,0]).set_fill(GREEN,opacity=0.2))
        EreignisB=always_redraw(lambda:EreignisBStart.copy().next_to(EreignisA,RIGHT,buff=[0,0,0]).set_fill(PURPLE,opacity=0.2))
        
        self.add(EreignisA,EreignisB,EreignisAcapBText,EreignisAcapnotBText,EreignisnotAcapnotBText,EreignisnotAcapBText)
        xEndeEnde=1.55
        yEndeEnde=2.45
        EreignisAEndeEnde=Rectangle(height=4,width=xEndeEnde,color=BLUE).set_fill(BLUE,opacity=1).align_to(EreignisAStart, LEFT+UP).set_stroke(BLACK,opacity=0)
        EreignisBEndeEnde=Rectangle(height=4,width=yEndeEnde,color=RED).set_fill(RED,opacity=1).next_to(EreignisAEndeEnde,buff=[0,0,0]).set_stroke(BLACK,opacity=0)
        #self.play(Transform(EreignisAStart,EreignisAEndeEnde),Transform(EreignisBStart,EreignisBEndeEnde),run_time=4)

        aMitte=1.75
        bMitte=1.5
        aLinieMitte=Line(start=[0,0,0],end=[2.5,0,0],color=BLACK,z_index=-10)
        bLinieMitte=Line(start=[0,0,0],end=[1.5,0,0],color=BLACK,z_index=-10)
        BedingungACopy=Rectangle(height=aStart,width=EreignisA.get_width(),color=YELLOW,z_index=2).set_fill(YELLOW,opacity=1).align_to(EreignisA,LEFT+DOWN).set_stroke(BLACK,opacity=0)

        BedingungACopyMitte=Rectangle(height=aMitte,width=EreignisA.get_width(),color=YELLOW,z_index=2).set_fill(YELLOW,opacity=1).align_to(EreignisA,LEFT+DOWN).set_stroke(BLACK,opacity=0)
        aEnde=2
        bEnde=2.5
        aLinieEnde=Line(start=[0,0,0],end=[2,0,0],color=BLACK,z_index=-10)
        bLinieEnde=Line(start=[0,0,0],end=[2.5,0,0],color=BLACK,z_index=-10)
        #self.play(Transform(aLinieStart,aLinieMitte),Transform(bLinieStart,bLinieMitte))
        #self.play(Transform(aLinieStart,aLinieEnde),Transform(bLinieStart,bLinieEnde))


        xEndeEndeEnde=2.45
        yEndeEndeEnde=1.55

        EreignisAEndeEndeEnde=Rectangle(height=4,width=xEndeEndeEnde,color=BLUE).set_fill(BLUE,opacity=1).align_to(EreignisAStart, LEFT+UP).set_stroke(BLACK,opacity=0)
        EreignisBEndeEndeEnde=Rectangle(height=4,width=yEndeEndeEnde,color=RED).set_fill(RED,opacity=1).next_to(EreignisAEndeEndeEnde,buff=[0,0,0]).set_stroke(BLACK,opacity=0)
        #self.play(Transform(EreignisAStart,EreignisAEndeEndeEnde),Transform(EreignisBStart,EreignisBEndeEndeEnde),run_time=4)

        self.wait(2)


        fraction = always_redraw(lambda:VGroup(
                BedingungA.copy(),
                Line(LEFT, RIGHT).match_width(VGroup(
                    BedingungA.copy(),
                    Tex("+"),
                    BedingungB.copy(),
                ).arrange(RIGHT, buff=SMALL_BUFF)),
                VGroup(
                    BedingungA.copy(),
                    Tex("+"),
                    BedingungB.copy(),
                ).arrange(RIGHT, buff=SMALL_BUFF)
            ).arrange(DOWN).move_to([4.55,-0.85,0]))
        #for x in range(len(fraction)):
        #    print(fraction[x])
        BeschriftungBruchZähler=always_redraw(lambda:Tex(r"$|A\cap B|$",color=BLACK,z_index=3).move_to(fraction[0].get_center()))
        BeschriftungBruchNennerSummand1=always_redraw(lambda:Tex(r"$|A\cap B|$",color=BLACK,z_index=3).move_to(fraction[2][0].get_center()))
        BeschriftungBruchNennerSummand2=always_redraw(lambda:Tex(r"$|\bar{A}\cap B|$",color=BLACK,z_index=3).move_to(fraction[2][2].get_center()))
        ÜberschriftBruch=Tex(r"$P_B(A)$").move_to([fraction.get_x(),ÜberschriftRechtesDiagramm.get_y(),0])#,substrings_to_isolate=["B","A"]).set_color_by_tex("B",YELLOW).set_color_by_tex("A",BLUE)

        #fraction.arrange(DOWN)
        #fraction[1].match_width(fraction)
        #fraction.to_edge(RIGHT)
        #fraction.next_to(EreignisB,RIGHT,buff=[0.75,0,0])

        #Bruch=Tex(r"${{{5}} \over {{5}}+{{20}}}$").set_color_by_tex("5",WHITE).set_color_by_tex("20",WHITE).scale(3).next_to(EreignisB,RIGHT)
        #self.add(fraction,BeschriftungBruchZähler,BeschriftungBruchNennerSummand1,BeschriftungBruchNennerSummand2,ÜberschriftBruch)

        BedingungACopy=BedingungA.copy()
        BedingungACopy2=BedingungA.copy()
        BedingungBCopy=BedingungB.copy()
        EreignisAcapBTextCopy=EreignisAcapBText.copy()
        EreignisAcapBTextCopy2=EreignisAcapBText.copy()
        EreignisnotAcapBTextCopy=EreignisnotAcapBText.copy()


        fracBlack=always_redraw(lambda:VGroup(
                BedingungA.copy().set_fill(BLACK).set_z_index(-1),
                Line(LEFT, RIGHT).match_width(VGroup(
                    BedingungA.copy().set_fill(BLACK).set_z_index(-1),
                    Tex("+"),
                    BedingungB.copy().set_fill(BLACK).set_z_index(-1),
                ).arrange(RIGHT, buff=SMALL_BUFF)),
                VGroup(
                    BedingungA.copy().set_fill(BLACK).set_z_index(-1),
                    Tex("+"),
                    BedingungB.copy().set_fill(BLACK).set_z_index(-1),
                ).arrange(RIGHT, buff=SMALL_BUFF)
            ).arrange(DOWN).move_to([4.55,-0.85,0]))

        self.play(FadeIn(ÜberschriftBruch))
        self.wait(3)
        self.play(FadeIn(fracBlack),BedingungACopy.animate.move_to(fracBlack[0].get_center()),EreignisAcapBTextCopy.animate.move_to(fracBlack[0].get_center()),rate_func=linear,run_time=5)
        self.add(BeschriftungBruchZähler)
        self.remove(EreignisAcapBTextCopy)
        self.wait(5)
        self.play(BedingungACopy2.animate.move_to(fracBlack[2][0].get_center()),EreignisAcapBTextCopy2.animate.move_to(fracBlack[2][0].get_center()),BedingungBCopy.animate.move_to(fracBlack[2][2].get_center()),EreignisnotAcapBTextCopy.animate.move_to(fracBlack[2][2].get_center()),rate_func=linear,run_time=2)
        self.add(BeschriftungBruchNennerSummand1,BeschriftungBruchNennerSummand2)
        self.remove(EreignisAcapBTextCopy2,EreignisnotAcapBTextCopy)
        self.remove(fracBlack,BedingungACopy,BedingungACopy2,BedingungBCopy)
        self.add(fraction)
        self.wait(3)
        self.play(Transform(EreignisAStart,EreignisAEndeEnde),Transform(EreignisBStart,EreignisBEndeEnde),run_time=3)
        self.play(Transform(EreignisAStart,EreignisAEndeEndeEnde),Transform(EreignisBStart,EreignisBEndeEndeEnde),run_time=3)
        self.wait(3)
        self.play(Transform(aLinieStart,aLinieMitte),Transform(bLinieStart,bLinieMitte),run_time=3)
        self.play(Transform(aLinieStart,aLinieEnde),Transform(bLinieStart,bLinieEnde),run_time=3)

        self.wait(5)


class Scene5(Scene):
    def construct(self):
        xStart=2.5
        yStart=1.5

        #EreignisABeginn=Rectangle(height=4,width=xStart,color=BLUE).set_fill(BLUE,opacity=1).move_to([-6.5,0,0]).set_stroke(BLACK,opacity=0)
        #EreignisBBeginn=Rectangle(height=4,width=yStart,color=RED).set_fill(RED,opacity=1).next_to(EreignisABeginn,buff=[0,0,0]).set_stroke(BLACK,opacity=0)
        Überschrift=Tex("Alternative Vorgehensweise").to_edge(UP)
        ul=Underline(Überschrift)
        self.add(Überschrift,ul)
        self.wait(2)
        EreignisAStart=Rectangle(height=xStart,width=4,color=BLUE,z_index=-1).set_fill(BLUE,opacity=1).move_to([-5,0.7,0]).set_stroke(BLACK,opacity=0)
        EreignisBStart=Rectangle(height=yStart,width=4,color=RED,z_index=-1).set_fill(RED,opacity=1).next_to(EreignisAStart,DOWN,buff=[0,0,0]).set_stroke(BLACK,opacity=0)
        EreignisAStartText=always_redraw(lambda:Tex(r"$B$",color=BLACK).move_to(EreignisAStart.get_center()))
        EreignisBStartText=always_redraw(lambda:Tex(r"$\bar{B}$",color=BLACK).move_to(EreignisBStart.get_center()))


        ÜberschriftLinkesDiagramm=Tex(r"Alle Möglichkeiten").move_to(EreignisAStart.get_top()+[0,0.5,0])
        
        self.add(EreignisAStart,EreignisAStartText,EreignisBStart,EreignisBStartText,ÜberschriftLinkesDiagramm)
        self.wait(3)

        EreignisA=EreignisAStart.copy().next_to(EreignisAStart,RIGHT,buff=0.75)
        EreignisAText=EreignisAStartText.copy().move_to(EreignisA.get_center())
        EreignisB=EreignisBStart.copy().next_to(EreignisBStart,RIGHT,buff=0.75).set_fill(opacity=0.2)
        EreignisBText=EreignisBStartText.copy().move_to(EreignisB.get_center())

        ÜberschriftRechtesDiagramm=Tex(r"...unter der Bedingung").move_to(EreignisA.get_top()+[0,0.5,0])

        self.add(EreignisA,EreignisB,EreignisAText,EreignisBText,ÜberschriftRechtesDiagramm)
        self.wait(3)
        
        SchnittA=Rectangle(height=xStart,width=1.58,color=YELLOW,z_index=0).set_fill(YELLOW,opacity=1).align_to(EreignisA,LEFT+DOWN).set_stroke(BLACK,opacity=0)
        SchnittB=Rectangle(height=xStart,width=2.42,color=ORANGE,z_index=0).set_fill(ORANGE,opacity=1).next_to(SchnittA,RIGHT,buff=0).set_stroke(BLACK,opacity=0)
        SchnittAText=Tex(r"$A\cap B$",color=BLACK,z_index=1).move_to(SchnittA.get_center())
        SchnittBText=Tex(r"$\bar{A}\cap B$",color=BLACK,z_index=1).move_to(SchnittB.get_center())

        self.add(SchnittA,SchnittB,SchnittAText,SchnittBText)
        self.wait(3)



        SchnittACopy=SchnittA.copy()
        SchnittACopy2=SchnittA.copy()

        SchnittBCopy=SchnittB.copy()
        SchnittATextCopy=SchnittAText.copy()
        SchnittATextCopy2=SchnittAText.copy()

        SchnittBTextCopy=SchnittBText.copy()


        fraction = always_redraw(lambda:VGroup(
                SchnittA.copy(),
                Line(LEFT, RIGHT).match_width(VGroup(
                    SchnittA.copy(),
                    Tex("+"),
                    SchnittB.copy(),
                ).arrange(RIGHT, buff=SMALL_BUFF)),
                VGroup(
                    SchnittA.copy(),
                    Tex("+"),
                    SchnittB.copy(),
                ).arrange(RIGHT, buff=SMALL_BUFF)
            ).arrange(DOWN).move_to([4.55,-0.85,0]))


        fracBlack=always_redraw(lambda:VGroup(
            SchnittA.copy().set_fill(BLACK).set_z_index(-1),
            Line(LEFT, RIGHT).match_width(VGroup(
                SchnittA.copy().set_fill(BLACK).set_z_index(-1),
                Tex("+"),
                SchnittB.copy().set_fill(BLACK).set_z_index(-1),
            ).arrange(RIGHT, buff=SMALL_BUFF)),
            VGroup(
                SchnittA.copy().set_fill(BLACK).set_z_index(-1),
                Tex("+"),
                SchnittB.copy().set_fill(BLACK).set_z_index(-1),
            ).arrange(RIGHT, buff=SMALL_BUFF)
        ).arrange(DOWN).move_to([4.55,-0.85,0]))
        ÜberschriftBruch=Tex(r"$P_B(A)$").move_to([fraction.get_x(),ÜberschriftRechtesDiagramm.get_y(),0])#,substrings_to_isolate=["B","A"]).set_color_by_tex("B",YELLOW).set_color_by_tex("A",BLUE)        
        self.add(ÜberschriftBruch)
        self.wait(2)
        self.play(FadeIn(fracBlack),SchnittACopy.animate.move_to(fracBlack[0].get_center()),SchnittATextCopy.animate.move_to(fracBlack[0].get_center()),SchnittACopy2.animate.move_to(fracBlack[2][0].get_center()),SchnittATextCopy2.animate.move_to(fracBlack[2][0].get_center()),SchnittBCopy.animate.move_to(fracBlack[2][2].get_center()),SchnittBTextCopy.animate.move_to(fracBlack[2][2].get_center()),rate_func=linear,run_time=3)
        BeschriftungBruchZähler=always_redraw(lambda:Tex(r"$|A\cap B|$",color=BLACK,z_index=3).move_to(fraction[0].get_center()))
        BeschriftungBruchNennerSummand1=always_redraw(lambda:Tex(r"$|A\cap B|$",color=BLACK,z_index=3).move_to(fraction[2][0].get_center()))
        BeschriftungBruchNennerSummand2=always_redraw(lambda:Tex(r"$|\bar{A}\cap B|$",color=BLACK,z_index=3).move_to(fraction[2][2].get_center()))
        self.add(BeschriftungBruchZähler,BeschriftungBruchNennerSummand1,BeschriftungBruchNennerSummand2)
        self.remove(SchnittACopy,SchnittACopy2,SchnittATextCopy,SchnittATextCopy2,SchnittBCopy,SchnittBTextCopy,fracBlack)
        self.add(fraction)
        self.wait(5)